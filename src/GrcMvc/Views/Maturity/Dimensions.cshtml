@using Microsoft.AspNetCore.Mvc.Localization
@inject IHtmlLocalizer<SharedResource> L
@model GrcMvc.Services.Interfaces.GrcMaturityScoreDto
@{
    ViewData["Title"] = L["MaturityDimensions"];
    Layout = "_Layout";
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a asp-action="CMM">@L["MaturityModel"]</a></li>
                    <li class="breadcrumb-item active">@L["Dimensions"]</li>
                </ol>
            </nav>
            <h2><i class="bi bi-grid-3x3-gap"></i> @L["MaturityDimensions"]</h2>
            <p class="text-muted">@L["DetailedBreakdownByDimension"]</p>
        </div>
        <div class="col text-end">
            <a asp-action="CMM" class="btn btn-outline-secondary">
                <i class="bi bi-bar-chart-steps"></i> @L["CMMView"]
            </a>
            <a asp-action="Roadmap" class="btn btn-outline-primary">
                <i class="bi bi-map"></i> @L["Roadmap"]
            </a>
            <a asp-action="Assessment" class="btn btn-primary">
                <i class="bi bi-clipboard-check"></i> @L["RunAssessment"]
            </a>
        </div>
    </div>

    <!-- Overall Score Card -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card bg-primary text-white shadow">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <h4><i class="bi bi-trophy"></i> @L["OverallMaturityLevel"]: <strong>@L["Level"] @Model.OverallLevel</strong></h4>
                            <p class="mb-0">@Model.LevelName (@Model.LevelNameAr)</p>
                        </div>
                        <div class="col-md-4 text-end">
                            <h1 class="display-3 mb-0">@Model.Score<small>/100</small></h1>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dimension Cards -->
    <div class="row">
        <!-- Governance -->
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="card shadow-sm h-100 border-top border-primary border-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="bi bi-shield-shaded text-primary"></i> @L["Governance"]
                    </h5>
                </div>
                <div class="card-body">
                    <div class="text-center mb-3">
                        <div class="display-4 text-primary">@Model.Governance.Level</div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-primary" role="progressbar"
                                 style="width: @(Model.Governance.Score)%"
                                 aria-valuenow="@Model.Governance.Score" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <small class="text-muted">@Model.Governance.Score/100</small>
                    </div>

                    @if (Model.Governance.Strengths.Any())
                    {
                        <h6 class="text-success"><i class="bi bi-check-circle"></i> @L["Strengths"]</h6>
                        <ul class="small">
                            @foreach (var strength in Model.Governance.Strengths.Take(3))
                            {
                                <li>@strength</li>
                            }
                        </ul>
                    }

                    @if (Model.Governance.Weaknesses.Any())
                    {
                        <h6 class="text-warning"><i class="bi bi-exclamation-triangle"></i> @L["AreasToImprove"]</h6>
                        <ul class="small mb-0">
                            @foreach (var weakness in Model.Governance.Weaknesses.Take(3))
                            {
                                <li>@weakness</li>
                            }
                        </ul>
                    }
                </div>
            </div>
        </div>

        <!-- Risk Management -->
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="card shadow-sm h-100 border-top border-danger border-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="bi bi-activity text-danger"></i> @L["RiskManagement"]
                    </h5>
                </div>
                <div class="card-body">
                    <div class="text-center mb-3">
                        <div class="display-4 text-danger">@Model.RiskManagement.Level</div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-danger" role="progressbar"
                                 style="width: @(Model.RiskManagement.Score)%"
                                 aria-valuenow="@Model.RiskManagement.Score" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <small class="text-muted">@Model.RiskManagement.Score/100</small>
                    </div>

                    @if (Model.RiskManagement.Strengths.Any())
                    {
                        <h6 class="text-success"><i class="bi bi-check-circle"></i> @L["Strengths"]</h6>
                        <ul class="small">
                            @foreach (var strength in Model.RiskManagement.Strengths.Take(3))
                            {
                                <li>@strength</li>
                            }
                        </ul>
                    }

                    @if (Model.RiskManagement.Weaknesses.Any())
                    {
                        <h6 class="text-warning"><i class="bi bi-exclamation-triangle"></i> @L["AreasToImprove"]</h6>
                        <ul class="small mb-0">
                            @foreach (var weakness in Model.RiskManagement.Weaknesses.Take(3))
                            {
                                <li>@weakness</li>
                            }
                        </ul>
                    }
                </div>
            </div>
        </div>

        <!-- Compliance -->
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="card shadow-sm h-100 border-top border-success border-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="bi bi-check-circle text-success"></i> @L["Compliance"]
                    </h5>
                </div>
                <div class="card-body">
                    <div class="text-center mb-3">
                        <div class="display-4 text-success">@Model.Compliance.Level</div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-success" role="progressbar"
                                 style="width: @(Model.Compliance.Score)%"
                                 aria-valuenow="@Model.Compliance.Score" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <small class="text-muted">@Model.Compliance.Score/100</small>
                    </div>

                    @if (Model.Compliance.Strengths.Any())
                    {
                        <h6 class="text-success"><i class="bi bi-check-circle"></i> @L["Strengths"]</h6>
                        <ul class="small">
                            @foreach (var strength in Model.Compliance.Strengths.Take(3))
                            {
                                <li>@strength</li>
                            }
                        </ul>
                    }

                    @if (Model.Compliance.Weaknesses.Any())
                    {
                        <h6 class="text-warning"><i class="bi bi-exclamation-triangle"></i> @L["AreasToImprove"]</h6>
                        <ul class="small mb-0">
                            @foreach (var weakness in Model.Compliance.Weaknesses.Take(3))
                            {
                                <li>@weakness</li>
                            }
                        </ul>
                    }
                </div>
            </div>
        </div>

        <!-- Operations -->
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="card shadow-sm h-100 border-top border-warning border-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="bi bi-gear text-warning"></i> @L["Operations"]
                    </h5>
                </div>
                <div class="card-body">
                    <div class="text-center mb-3">
                        <div class="display-4 text-warning">@Model.Operations.Level</div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-warning" role="progressbar"
                                 style="width: @(Model.Operations.Score)%"
                                 aria-valuenow="@Model.Operations.Score" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <small class="text-muted">@Model.Operations.Score/100</small>
                    </div>

                    @if (Model.Operations.Strengths.Any())
                    {
                        <h6 class="text-success"><i class="bi bi-check-circle"></i> @L["Strengths"]</h6>
                        <ul class="small">
                            @foreach (var strength in Model.Operations.Strengths.Take(3))
                            {
                                <li>@strength</li>
                            }
                        </ul>
                    }

                    @if (Model.Operations.Weaknesses.Any())
                    {
                        <h6 class="text-warning"><i class="bi bi-exclamation-triangle"></i> @L["AreasToImprove"]</h6>
                        <ul class="small mb-0">
                            @foreach (var weakness in Model.Operations.Weaknesses.Take(3))
                            {
                                <li>@weakness</li>
                            }
                        </ul>
                    }
                </div>
            </div>
        </div>

        <!-- Technology -->
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="card shadow-sm h-100 border-top border-info border-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="bi bi-cpu text-info"></i> @L["Technology"]
                    </h5>
                </div>
                <div class="card-body">
                    <div class="text-center mb-3">
                        <div class="display-4 text-info">@Model.Technology.Level</div>
                        <div class="progress" style="height: 10px;">
                            <div class="progress-bar bg-info" role="progressbar"
                                 style="width: @(Model.Technology.Score)%"
                                 aria-valuenow="@Model.Technology.Score" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <small class="text-muted">@Model.Technology.Score/100</small>
                    </div>

                    @if (Model.Technology.Strengths.Any())
                    {
                        <h6 class="text-success"><i class="bi bi-check-circle"></i> @L["Strengths"]</h6>
                        <ul class="small">
                            @foreach (var strength in Model.Technology.Strengths.Take(3))
                            {
                                <li>@strength</li>
                            }
                        </ul>
                    }

                    @if (Model.Technology.Weaknesses.Any())
                    {
                        <h6 class="text-warning"><i class="bi bi-exclamation-triangle"></i> @L["AreasToImprove"]</h6>
                        <ul class="small mb-0">
                            @foreach (var weakness in Model.Technology.Weaknesses.Take(3))
                            {
                                <li>@weakness</li>
                            }
                        </ul>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Radar Chart -->
    <div class="row mt-4">
        <div class="col-lg-6 offset-lg-3">
            <div class="card shadow-sm">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-diagram-3"></i> @L["DimensionRadarChart"]</h5>
                </div>
                <div class="card-body">
                    <canvas id="radarChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const ctx = document.getElementById('radarChart').getContext('2d');
        new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['Governance', 'Risk Management', 'Compliance', 'Operations', 'Technology'],
                datasets: [{
                    label: 'Current Level',
                    data: [
                        @Model.Governance.Level,
                        @Model.RiskManagement.Level,
                        @Model.Compliance.Level,
                        @Model.Operations.Level,
                        @Model.Technology.Level
                    ],
                    fill: true,
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    borderColor: 'rgb(54, 162, 235)',
                    pointBackgroundColor: 'rgb(54, 162, 235)',
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: 'rgb(54, 162, 235)'
                }, {
                    label: 'Target (Level 4)',
                    data: [4, 4, 4, 4, 4],
                    fill: true,
                    backgroundColor: 'rgba(75, 192, 192, 0.1)',
                    borderColor: 'rgb(75, 192, 192)',
                    pointBackgroundColor: 'rgb(75, 192, 192)',
                    borderDash: [5, 5]
                }]
            },
            options: {
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 5,
                        ticks: {
                            stepSize: 1
                        }
                    }
                }
            }
        });
    </script>
}
