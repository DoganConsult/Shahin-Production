@{
    ViewData["Title"] = "Analytics Dashboard";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h1 class="h2 mb-1"><i class="fas fa-chart-pie text-purple me-2" style="color:#9B59B6;"></i>Analytics Dashboard</h1>
            <p class="text-muted">Compliance metrics, trends, and insights</p>
        </div>
        <a asp-action="Trends" class="btn btn-outline-primary"><i class="fas fa-chart-line me-2"></i>View Trends</a>
    </div>

    <!-- Key Metrics -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="display-4 fw-bold text-success">@ViewBag.ComplianceScore%</div>
                    <div class="text-muted">Compliance Score</div>
                    <div class="progress mt-2" style="height: 8px;">
                        <div class="progress-bar bg-success" style="width: @ViewBag.ComplianceScore%"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="display-4 fw-bold text-info">@ViewBag.EvidenceApprovalRate%</div>
                    <div class="text-muted">Evidence Approval Rate</div>
                    <div class="progress mt-2" style="height: 8px;">
                        <div class="progress-bar bg-info" style="width: @ViewBag.EvidenceApprovalRate%"></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="display-4 fw-bold text-primary">@ViewBag.ActiveWorkflows</div>
                    <div class="text-muted">Active Workflows</div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="display-4 fw-bold text-warning">@ViewBag.OpenExceptions</div>
                    <div class="text-muted">Open Exceptions</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Drill-down Cards -->
    <div class="row">
        <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-primary text-white">
                    <i class="fas fa-clipboard-check me-2"></i>Assessments
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-3">
                        <span>Total</span>
                        <strong>@ViewBag.TotalAssessments</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-3">
                        <span>Completed</span>
                        <strong class="text-success">@ViewBag.CompletedAssessments</strong>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>In Progress</span>
                        <strong class="text-warning">@(ViewBag.TotalAssessments - ViewBag.CompletedAssessments)</strong>
                    </div>
                </div>
                <div class="card-footer bg-transparent">
                    <a asp-action="Drilldown" asp-route-type="assessments" class="btn btn-sm btn-outline-primary w-100">View Details</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-success text-white">
                    <i class="fas fa-file-alt me-2"></i>Evidence
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-3">
                        <span>Total</span>
                        <strong>@ViewBag.TotalEvidence</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-3">
                        <span>Approved</span>
                        <strong class="text-success">@ViewBag.ApprovedEvidence</strong>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span>Pending</span>
                        <strong class="text-warning">@(ViewBag.TotalEvidence - ViewBag.ApprovedEvidence)</strong>
                    </div>
                </div>
                <div class="card-footer bg-transparent">
                    <a asp-action="Drilldown" asp-route-type="evidence" class="btn btn-sm btn-outline-success w-100">View Details</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-info text-white">
                    <i class="fas fa-project-diagram me-2"></i>Workflows
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-3">
                        <span>Active</span>
                        <strong class="text-primary">@ViewBag.ActiveWorkflows</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-3">
                        <span>Open Exceptions</span>
                        <strong class="text-warning">@ViewBag.OpenExceptions</strong>
                    </div>
                </div>
                <div class="card-footer bg-transparent">
                    <a asp-action="Drilldown" asp-route-type="workflows" class="btn btn-sm btn-outline-info w-100">View Details</a>
                </div>
            </div>
        </div>
    </div>
</div>
