@model string

@{
    var fieldName = ViewData.TemplateInfo.HtmlFieldPrefix;
    var uniqueId = Guid.NewGuid().ToString("N").Substring(0, 8);
}

<div class="grc-password-editor">
    <div class="input-group">
        <input type="password"
               id="@fieldName"
               name="@fieldName"
               value=""
               class="form-control password-input-@uniqueId"
               autocomplete="new-password"
               placeholder="@Localizer["Password_Placeholder"]" />
        <button type="button" class="btn btn-outline-secondary toggle-password-@uniqueId" tabindex="-1">
            <i class="bi bi-eye"></i>
        </button>
    </div>
    <div class="password-strength mt-2" id="strength-@uniqueId">
        <div class="progress" style="height: 4px;">
            <div class="progress-bar" role="progressbar" style="width: 0%"></div>
        </div>
        <small class="text-muted strength-text"></small>
    </div>
</div>

<script>
    (function() {
        const input = document.querySelector('.password-input-@uniqueId');
        const toggle = document.querySelector('.toggle-password-@uniqueId');
        const strengthDiv = document.getElementById('strength-@uniqueId');
        const progressBar = strengthDiv.querySelector('.progress-bar');
        const strengthText = strengthDiv.querySelector('.strength-text');
        const strengthLabels = ['@Localizer["Password_VeryWeak"]', '@Localizer["Password_Weak"]', '@Localizer["Password_Fair"]', '@Localizer["Password_Strong"]', '@Localizer["Password_VeryStrong"]'];

        toggle.addEventListener('click', function() {
            const type = input.type === 'password' ? 'text' : 'password';
            input.type = type;
            this.querySelector('i').classList.toggle('bi-eye');
            this.querySelector('i').classList.toggle('bi-eye-slash');
        });

        input.addEventListener('input', function() {
            const value = this.value;
            let strength = 0;
            if (value.length >= 8) strength += 25;
            if (/[a-z]/.test(value) && /[A-Z]/.test(value)) strength += 25;
            if (/\d/.test(value)) strength += 25;
            if (/[^a-zA-Z0-9]/.test(value)) strength += 25;

            progressBar.style.width = strength + '%';
            progressBar.className = 'progress-bar ' + (strength <= 25 ? 'bg-danger' : strength <= 50 ? 'bg-warning' : strength <= 75 ? 'bg-info' : 'bg-success');
            strengthText.textContent = strengthLabels[Math.floor(strength / 25)];
        });
    })();
</script>
