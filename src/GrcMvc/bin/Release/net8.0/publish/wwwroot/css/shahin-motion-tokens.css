/**
 * Shahin Motion Tokens (Global)
 * Enterprise-safe motion system for entire application
 * Load after shahin-design-system.css, before shahin-custom.css
 */

/* ============================================================================
   Global Motion Tokens (Enterprise-safe)
   ============================================================================ */
:root {
    /* ------------------------------------------------------------------------
       Durations
       - fast: micro-interactions (icons, badges)
       - interactive: hover/focus/toggle states
       - base: most UI transitions
       - slow: large panel moves
       - content: page/step entry animations
    ------------------------------------------------------------------------ */
    --motion-dur-fast: 150ms;
    --motion-dur-interactive: 200ms;
    --motion-dur-base: 250ms;
    --motion-dur-slow: 350ms;
    --motion-dur-content: 400ms;

    /* ------------------------------------------------------------------------
       Easing
       - standard: general purpose (Material Design standard)
       - emphasized: attention-drawing moves (decelerate curve)
    ------------------------------------------------------------------------ */
    --motion-ease-standard: cubic-bezier(0.4, 0, 0.2, 1);
    --motion-ease-emphasized: cubic-bezier(0.2, 0.0, 0, 1);

    /* ------------------------------------------------------------------------
       Transition Tokens (duration + easing)
       - Falls back to Shahin Design System tokens if available
    ------------------------------------------------------------------------ */
    --motion-t-fast: var(--shahin-transition-fast, var(--motion-dur-fast) var(--motion-ease-standard));
    --motion-t-base: var(--shahin-transition-base, var(--motion-dur-base) var(--motion-ease-standard));
    --motion-t-slow: var(--shahin-transition-slow, var(--motion-dur-slow) var(--motion-ease-standard));
    --motion-t-interactive: var(--motion-dur-interactive) var(--motion-ease-standard);

    /* ------------------------------------------------------------------------
       Distance Tokens (for transforms)
    ------------------------------------------------------------------------ */
    --motion-shift-sm: 12px;
    --motion-shift-md: 20px;
    --motion-shift-lg: 30px;

    /* ------------------------------------------------------------------------
       Direction (RTL-safe)
       - Use calc(var(--motion-dir) * distance) for horizontal transforms
    ------------------------------------------------------------------------ */
    --motion-dir: 1;
}

/* RTL flips direction */
[dir="rtl"] {
    --motion-dir: -1;
}

/* ============================================================================
   Global Reduce Motion Policy
   Respects user's accessibility preferences
   ============================================================================ */
@media (prefers-reduced-motion: reduce) {
    /* Disable smooth scrolling */
    html:focus-within {
        scroll-behavior: auto;
    }

    /* Kill all motion globally */
    *,
    *::before,
    *::after {
        animation-duration: 1ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 1ms !important;
        scroll-behavior: auto !important;
    }
}

/* ============================================================================
   Table Motion Rules (Enterprise-safe)
   Consistent motion for all table/list views
   ============================================================================ */

/* Table row hover/focus (no layout shift) */
.table tbody tr {
    transition: background-color var(--motion-t-interactive);
}

.table tbody tr:focus-within {
    outline: 2px solid rgba(59, 130, 246, 0.35);
    outline-offset: -2px;
    transition: outline-color var(--motion-t-interactive);
}

/* Inline validation feedback (enterprise micro-interactions) */
.field-validation-error,
.validation-summary-errors {
    animation: none;
}

.is-invalid {
    transition: border-color var(--motion-t-interactive), box-shadow var(--motion-t-interactive);
}

.is-valid {
    transition: border-color var(--motion-t-interactive), box-shadow var(--motion-t-interactive);
}

/* Expand/collapse for table details (progressive disclosure) */
.row-details {
    max-height: 0;
    opacity: 0;
    overflow: hidden;
    transition: max-height var(--motion-t-base), opacity var(--motion-t-base);
}

.row-details.show {
    max-height: 480px;
    opacity: 1;
}

/* ============================================================================
   Loading States (Skeleton)
   Prefer skeleton shimmer over spinner for tables
   ============================================================================ */
.skeleton {
    position: relative;
    overflow: hidden;
    background: rgba(148, 163, 184, 0.18);
    border-radius: 8px;
}

.skeleton::after {
    content: "";
    position: absolute;
    inset: 0;
    transform: translateX(-100%);
    animation: skeletonShimmer 1.2s linear infinite;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.35), transparent);
}

@keyframes skeletonShimmer {
    to {
        transform: translateX(100%);
    }
}

@media (prefers-reduced-motion: reduce) {
    .skeleton::after {
        animation: none;
    }
}

/* ============================================================================
   Form Input Transitions
   Consistent focus/validation states
   ============================================================================ */
.form-control,
.form-select {
    transition: border-color var(--motion-t-interactive), box-shadow var(--motion-t-interactive);
}

/* Button transitions */
.btn {
    transition: background-color var(--motion-t-interactive),
                border-color var(--motion-t-interactive),
                box-shadow var(--motion-t-interactive),
                transform var(--motion-t-fast);
}

/* Card transitions */
.card {
    transition: box-shadow var(--motion-t-base), transform var(--motion-t-base);
}

/* Badge/alert transitions */
.badge,
.alert {
    transition: opacity var(--motion-t-fast), transform var(--motion-t-fast);
}

/* Dropdown menu transitions */
.dropdown-menu {
    transition: opacity var(--motion-t-fast), transform var(--motion-t-fast);
}

/* Modal backdrop */
.modal-backdrop {
    transition: opacity var(--motion-t-base);
}

/* Collapse transitions */
.collapse,
.collapsing {
    transition: height var(--motion-t-base);
}

/* Tab transitions */
.tab-content > .tab-pane {
    transition: opacity var(--motion-t-base);
}

/* ============================================================================
   Modal & Offcanvas (RTL-safe)
   Enterprise-safe slide patterns
   ============================================================================ */

/* Modal fade */
.modal.fade .modal-dialog {
    transform: translateY(calc(-1 * var(--motion-shift-md)));
    opacity: 0;
    transition: transform var(--motion-t-base), opacity var(--motion-t-base);
}

.modal.show .modal-dialog {
    transform: translateY(0);
    opacity: 1;
}

/* Shahin modal close button */
.shahin-modal-close {
    transition: background-color var(--motion-t-interactive), color var(--motion-t-interactive);
}

/* Offcanvas slide (RTL-safe) */
.offcanvas {
    transition: transform var(--motion-t-base), opacity var(--motion-t-base);
}

.offcanvas-start {
    transform: translateX(calc(var(--motion-dir) * -100%));
}

.offcanvas-end {
    transform: translateX(calc(var(--motion-dir) * 100%));
}

.offcanvas.show {
    transform: translateX(0);
}

/* ============================================================================
   Dropdown & Tooltip/Popover
   Subtle opacity + small translate (no bounce/scale)
   ============================================================================ */

/* Dropdown menu - subtle entry */
.dropdown-menu {
    transform: translateY(6px);
    opacity: 0;
    transition: transform var(--motion-t-interactive), opacity var(--motion-t-interactive);
}

.dropdown-menu.show {
    transform: translateY(0);
    opacity: 1;
}

/* Dropdown item hover */
.dropdown-item {
    transition: background-color var(--motion-t-fast), color var(--motion-t-fast);
}

/* Tooltip - subtle fade */
.tooltip {
    transition: opacity var(--motion-t-fast);
}

/* Popover - subtle entry */
.popover {
    transform: translateY(4px);
    opacity: 0;
    transition: transform var(--motion-t-interactive), opacity var(--motion-t-interactive);
}

.popover.show {
    transform: translateY(0);
    opacity: 1;
}

/* ============================================================================
   Toast & Alert
   Consistent entry transitions
   ============================================================================ */

/* Toast slide-in */
.toast {
    transform: translateY(var(--motion-shift-sm));
    opacity: 0;
    transition: transform var(--motion-t-base), opacity var(--motion-t-base);
}

.toast.show,
.toast.showing {
    transform: translateY(0);
    opacity: 1;
}

/* Alert dismiss */
.alert-dismissible .btn-close {
    transition: opacity var(--motion-t-fast);
}

/* ============================================================================
   Utility Animation Classes
   Common patterns with reduce-motion fallbacks
   ============================================================================ */

/* Pulse animation (attention) */
.pulse {
    animation: pulseAnimation 2s ease-in-out infinite;
}

@keyframes pulseAnimation {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.6; }
}

/* Shake animation (error feedback) */
.shake {
    animation: shakeAnimation 0.5s ease-in-out;
}

@keyframes shakeAnimation {
    0%, 100% { transform: translateX(0); }
    20%, 60% { transform: translateX(-4px); }
    40%, 80% { transform: translateX(4px); }
}

/* Spin animation (loading) */
.spin {
    animation: spinAnimation 1s linear infinite;
}

@keyframes spinAnimation {
    to { transform: rotate(360deg); }
}

/* Fade in/out utilities */
.fade-in {
    animation: fadeInAnimation var(--motion-dur-base) var(--motion-ease-standard);
}

@keyframes fadeInAnimation {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* ============================================================================
   Reduce Motion - Utility Classes
   Ensures pulse/shake/spin degrade gracefully
   ============================================================================ */
@media (prefers-reduced-motion: reduce) {
    .pulse,
    .shake,
    .spin {
        animation: none !important;
    }

    .fade-in {
        animation: none !important;
        opacity: 1;
    }

    /* Offcanvas - instant show */
    .offcanvas,
    .offcanvas-start,
    .offcanvas-end {
        transition: none !important;
    }

    /* Modal - instant show */
    .modal.fade .modal-dialog {
        transition: none !important;
        transform: none !important;
    }

    /* Dropdown - instant show */
    .dropdown-menu {
        transition: none !important;
        transform: none !important;
    }

    /* Tooltip/Popover - instant show */
    .tooltip,
    .popover {
        transition: none !important;
        transform: none !important;
    }

    /* Toast - instant show */
    .toast {
        transition: none !important;
        transform: none !important;
    }
}
