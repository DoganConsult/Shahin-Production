@*
    SHAHIN AI GRC - Avatar/Profile Component
    Usage: <partial name="Components/_ShahinAvatar" model='new {
        Name = "John Doe",
        ImageUrl = "/images/avatar.jpg",
        Size = "md",
        Status = "online",
        Shape = "circle",
        ShowBadge = true
    }' />
*@
@{
    dynamic model = ViewData.Model ?? new { };
    var name = model?.Name ?? "";
    var imageUrl = model?.ImageUrl ?? "";
    var size = model?.Size ?? "md"; // xs, sm, md, lg, xl, xxl
    var status = model?.Status ?? ""; // online, offline, busy, away
    var shape = model?.Shape ?? "circle"; // circle, square, rounded
    var showBadge = model?.ShowBadge ?? false;
    var badge = model?.Badge ?? "";
    var initials = model?.Initials ?? "";

    if (string.IsNullOrEmpty(initials) && !string.IsNullOrEmpty(name))
    {
        var names = name.Split(' ', StringSplitOptions.RemoveEmptyEntries);
        initials = names.Length >= 2
            ? $"{names[0][0]}{names[1][0]}"
            : names[0].Length >= 2
                ? $"{names[0][0]}{names[0][1]}"
                : $"{names[0][0]}";
        initials = initials.ToUpper();
    }

    var sizeClass = $"shahin-avatar-{size}";
    var shapeClass = $"shahin-avatar-{shape}";
    var hasImage = !string.IsNullOrEmpty(imageUrl);
}

<div class="shahin-avatar @sizeClass @shapeClass @(!string.IsNullOrEmpty(status) ? "shahin-avatar-status" : "")"
     title="@name">
    @if (hasImage)
    {
        <img src="@imageUrl" alt="@name" class="shahin-avatar-image" />
    }
    else
    {
        <div class="shahin-avatar-initials">@initials</div>
    }

    @if (!string.IsNullOrEmpty(status))
    {
        <span class="shahin-avatar-status-indicator shahin-avatar-status-@status"></span>
    }

    @if (showBadge && !string.IsNullOrEmpty(badge))
    {
        <span class="shahin-avatar-badge">@badge</span>
    }
</div>

<style>
    .shahin-avatar {
        position: relative;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, var(--shahin-primary), var(--shahin-secondary));
        color: var(--shahin-white);
        font-weight: var(--shahin-font-weight-bold);
        overflow: hidden;
        flex-shrink: 0;
    }

    .shahin-avatar-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .shahin-avatar-initials {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
        user-select: none;
    }

    /* Sizes */
    .shahin-avatar-xs {
        width: 1.5rem;
        height: 1.5rem;
        font-size: var(--shahin-font-size-xs);
    }

    .shahin-avatar-sm {
        width: 2rem;
        height: 2rem;
        font-size: var(--shahin-font-size-sm);
    }

    .shahin-avatar-md {
        width: 2.5rem;
        height: 2.5rem;
        font-size: var(--shahin-font-size-base);
    }

    .shahin-avatar-lg {
        width: 3.5rem;
        height: 3.5rem;
        font-size: var(--shahin-font-size-lg);
    }

    .shahin-avatar-xl {
        width: 5rem;
        height: 5rem;
        font-size: var(--shahin-font-size-2xl);
    }

    .shahin-avatar-xxl {
        width: 8rem;
        height: 8rem;
        font-size: var(--shahin-font-size-4xl);
    }

    /* Shapes */
    .shahin-avatar-circle {
        border-radius: 50%;
    }

    .shahin-avatar-rounded {
        border-radius: var(--shahin-radius-base);
    }

    .shahin-avatar-square {
        border-radius: 0;
    }

    /* Status Indicator */
    .shahin-avatar-status-indicator {
        position: absolute;
        bottom: 0;
        right: 0;
        width: 25%;
        height: 25%;
        border-radius: 50%;
        border: 2px solid var(--shahin-white);
    }

    .shahin-avatar-status-online {
        background-color: var(--shahin-success);
    }

    .shahin-avatar-status-offline {
        background-color: var(--shahin-gray-400);
    }

    .shahin-avatar-status-busy {
        background-color: var(--shahin-error);
    }

    .shahin-avatar-status-away {
        background-color: var(--shahin-warning);
    }

    /* Badge */
    .shahin-avatar-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        min-width: 1.25rem;
        height: 1.25rem;
        padding: 0 var(--shahin-space-1);
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: var(--shahin-error);
        color: var(--shahin-white);
        font-size: var(--shahin-font-size-xs);
        font-weight: var(--shahin-font-weight-bold);
        border-radius: var(--shahin-radius-full);
        border: 2px solid var(--shahin-white);
    }

    /* Avatar Group */
    .shahin-avatar-group {
        display: flex;
        align-items: center;
    }

    .shahin-avatar-group .shahin-avatar {
        margin-left: -0.75rem;
        border: 2px solid var(--shahin-white);
    }

    .shahin-avatar-group .shahin-avatar:first-child {
        margin-left: 0;
    }

    .shahin-avatar-group .shahin-avatar:hover {
        z-index: 1;
        transform: scale(1.1);
        transition: transform var(--shahin-transition-fast);
    }

    [dir="rtl"] .shahin-avatar-status-indicator {
        right: auto;
        left: 0;
    }

    [dir="rtl"] .shahin-avatar-badge {
        right: auto;
        left: -5px;
    }

    [dir="rtl"] .shahin-avatar-group .shahin-avatar {
        margin-left: 0;
        margin-right: -0.75rem;
    }

    [dir="rtl"] .shahin-avatar-group .shahin-avatar:first-child {
        margin-right: 0;
    }
</style>
