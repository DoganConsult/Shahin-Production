@*
    SHAHIN AI GRC - Breadcrumb Component
    Usage: <partial name="Components/_ShahinBreadcrumb" model='new {
        Items = new[] {
            new { Text = "Home", Url = "/" },
            new { Text = "Risks", Url = "/Risk" },
            new { Text = "Risk Details", Url = "" }
        }
    }' />
*@
@{
    dynamic model = ViewData.Model ?? new { };
    var items = model?.Items as IEnumerable<dynamic> ?? new List<dynamic>();
    var separator = model?.Separator ?? "/";
    var showHome = model?.ShowHome ?? true;
}

<nav aria-label="breadcrumb">
    <ol class="breadcrumb shahin-breadcrumb">
        @if (showHome && !items.Any(i => i.Text?.ToString()?.ToLower() == "home"))
        {
            <li class="breadcrumb-item">
                <a href="/">
                    <i class="bi bi-house-fill"></i>
                </a>
            </li>
        }

        @{
            var itemList = items.ToList();
            for (int i = 0; i < itemList.Count; i++)
            {
                var item = itemList[i];
                var isLast = i == itemList.Count - 1;
                var text = item.Text?.ToString() ?? "";
                var url = item.Url?.ToString() ?? "";
                var hasUrl = !string.IsNullOrEmpty(url);

                <li class="breadcrumb-item @(isLast ? "active" : "")" @(isLast ? Html.Raw("aria-current=\"page\"") : null)>
                    @if (hasUrl && !isLast)
                    {
                        <a href="@url">@text</a>
                    }
                    else
                    {
                        @text
                    }
                </li>
            }
        }
    </ol>
</nav>

<style>
    .shahin-breadcrumb {
        display: flex;
        flex-wrap: wrap;
        padding: var(--shahin-space-3) var(--shahin-space-4);
        margin-bottom: var(--shahin-space-4);
        list-style: none;
        background-color: var(--shahin-gray-50);
        border-radius: var(--shahin-radius-base);
    }

    .shahin-breadcrumb .breadcrumb-item {
        display: flex;
        align-items: center;
        font-size: var(--shahin-font-size-sm);
        color: var(--shahin-gray-600);
    }

    .shahin-breadcrumb .breadcrumb-item + .breadcrumb-item::before {
        content: "/";
        padding: 0 var(--shahin-space-2);
        color: var(--shahin-gray-400);
    }

    .shahin-breadcrumb .breadcrumb-item a {
        color: var(--shahin-primary);
        text-decoration: none;
        transition: color var(--shahin-transition-fast);
    }

    .shahin-breadcrumb .breadcrumb-item a:hover {
        color: var(--shahin-primary-hover);
        text-decoration: underline;
    }

    .shahin-breadcrumb .breadcrumb-item.active {
        color: var(--shahin-gray-700);
        font-weight: var(--shahin-font-weight-medium);
    }

    [dir="rtl"] .shahin-breadcrumb .breadcrumb-item + .breadcrumb-item::before {
        content: "\\";
    }
</style>
