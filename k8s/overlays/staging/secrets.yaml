# =============================================================================
# STAGING SECRETS - Shahin GRC Platform
# =============================================================================
# INSTRUCTIONS:
# 1. Copy this file to secrets.local.yaml (gitignored)
# 2. Generate secure passwords using: openssl rand -base64 24
# 3. Update all values marked with "CHANGE_ME"
# 4. Apply with: kubectl apply -f secrets.local.yaml
#
# Staging should use moderately secure passwords (not as strict as production)
# =============================================================================
---
apiVersion: v1
kind: Secret
metadata:
  name: db-credentials
  namespace: shahin-grc-staging
  labels:
    environment: staging
type: Opaque
stringData:
  # PostgreSQL credentials - Use stronger passwords than dev
  POSTGRES_USER: "shahin_admin"
  POSTGRES_PASSWORD: "CHANGE_ME_STAGING_DB_PASS"    # Generate: openssl rand -base64 24
  POSTGRES_DB: "GrcMvcDb"

  # Replication credentials (required for HA with Patroni)
  REPLICATION_USER: "replicator"
  REPLICATION_PASSWORD: "CHANGE_ME_REPLICA_PASS"   # Generate: openssl rand -base64 24

  # Connection strings
  # Note: staging-postgres references the Kustomize-prefixed service name
  CONNECTION_STRING: "Host=staging-postgres-headless;Database=GrcMvcDb;Username=shahin_admin;Password=CHANGE_ME_STAGING_DB_PASS;Port=5432;SSL Mode=Prefer"
  AUTH_CONNECTION_STRING: "Host=staging-postgres-headless;Database=GrcAuthDb;Username=shahin_admin;Password=CHANGE_ME_STAGING_DB_PASS;Port=5432;SSL Mode=Prefer"
---
apiVersion: v1
kind: Secret
metadata:
  name: jwt-secret
  namespace: shahin-grc-staging
  labels:
    environment: staging
type: Opaque
stringData:
  # JWT Configuration
  # Generate secret: openssl rand -base64 48
  JWT_SECRET: "CHANGE_ME_JWT_SECRET_MIN_32_CHARS"
  JWT_ISSUER: "shahin-grc-staging"
  JWT_AUDIENCE: "shahin-grc-staging-users"
  JWT_EXPIRY_MINUTES: "60"                         # 1 hour for staging
---
apiVersion: v1
kind: Secret
metadata:
  name: claude-api-key
  namespace: shahin-grc-staging
  labels:
    environment: staging
type: Opaque
stringData:
  # Claude AI Configuration
  # Get your API key from: https://console.anthropic.com/
  # Consider using a separate API key for staging with usage limits
  CLAUDE_API_KEY: "sk-ant-api03-CHANGE_ME"         # REQUIRED
  CLAUDE_MODEL: "claude-sonnet-4-5-20250514"
  CLAUDE_ENABLED: "true"
---
apiVersion: v1
kind: Secret
metadata:
  name: redis-password
  namespace: shahin-grc-staging
  labels:
    environment: staging
type: Opaque
stringData:
  # Generate: openssl rand -base64 24
  REDIS_PASSWORD: "CHANGE_ME_REDIS_PASS"
  # Sentinel connection for HA Redis
  REDIS_CONNECTION: "staging-redis-sentinel-svc:26379,serviceName=shahin-master,password=CHANGE_ME_REDIS_PASS"
---
# Docker registry secret for pulling images from GHCR
apiVersion: v1
kind: Secret
metadata:
  name: ghcr-secret
  namespace: shahin-grc-staging
  labels:
    environment: staging
type: kubernetes.io/dockerconfigjson
stringData:
  .dockerconfigjson: |
    {
      "auths": {
        "ghcr.io": {
          "username": "CHANGE_ME_GITHUB_USERNAME",
          "password": "CHANGE_ME_GITHUB_PAT",
          "auth": ""
        }
      }
    }
---
# Optional: SMTP credentials for email notifications
apiVersion: v1
kind: Secret
metadata:
  name: smtp-credentials
  namespace: shahin-grc-staging
  labels:
    environment: staging
type: Opaque
stringData:
  SMTP_HOST: "smtp.example.com"
  SMTP_PORT: "587"
  SMTP_USERNAME: "CHANGE_ME"
  SMTP_PASSWORD: "CHANGE_ME"
  SMTP_FROM_EMAIL: "staging-noreply@shahin-ai.com"
  SMTP_FROM_NAME: "Shahin GRC (Staging)"
