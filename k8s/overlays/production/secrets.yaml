# =============================================================================
# PRODUCTION SECRETS - Shahin GRC Platform
# =============================================================================
# ⚠️  CRITICAL SECURITY INSTRUCTIONS:
#
# 1. NEVER commit this file with real values to version control
# 2. Copy to secrets.local.yaml and add to .gitignore
# 3. Generate ALL passwords using: openssl rand -base64 32
# 4. Store secrets in a secure vault (HashiCorp Vault, AWS Secrets Manager, etc.)
# 5. Consider using Sealed Secrets or External Secrets Operator
# 6. Rotate secrets regularly (at least every 90 days)
#
# Password Requirements:
# - Minimum 32 characters
# - Mix of uppercase, lowercase, numbers, special characters
# - Unique for each service
# =============================================================================
---
apiVersion: v1
kind: Secret
metadata:
  name: db-credentials
  namespace: shahin-grc
  labels:
    environment: production
  annotations:
    # Reminder for secret rotation
    secret-rotation-date: "2026-04-14"
type: Opaque
stringData:
  # PostgreSQL credentials
  # Generate: openssl rand -base64 32
  POSTGRES_USER: "shahin_admin"
  POSTGRES_PASSWORD: "CHANGE_ME_GENERATE_32_CHAR_PASSWORD"
  POSTGRES_DB: "GrcMvcDb"

  # Replication credentials (REQUIRED for Patroni HA)
  # Generate: openssl rand -base64 32
  REPLICATION_USER: "replicator"
  REPLICATION_PASSWORD: "CHANGE_ME_GENERATE_32_CHAR_PASSWORD"

  # Production connection strings with SSL enabled
  # Uses internal K8s DNS: postgres-headless.shahin-grc.svc.cluster.local
  CONNECTION_STRING: "Host=postgres-headless;Database=GrcMvcDb;Username=shahin_admin;Password=CHANGE_ME_GENERATE_32_CHAR_PASSWORD;Port=5432;SSL Mode=Require;Trust Server Certificate=true;Pooling=true;Maximum Pool Size=100"
  AUTH_CONNECTION_STRING: "Host=postgres-headless;Database=GrcAuthDb;Username=shahin_admin;Password=CHANGE_ME_GENERATE_32_CHAR_PASSWORD;Port=5432;SSL Mode=Require;Trust Server Certificate=true;Pooling=true;Maximum Pool Size=50"
---
apiVersion: v1
kind: Secret
metadata:
  name: jwt-secret
  namespace: shahin-grc
  labels:
    environment: production
  annotations:
    secret-rotation-date: "2026-04-14"
type: Opaque
stringData:
  # JWT Configuration - CRITICAL SECURITY
  # Generate: openssl rand -base64 64
  # Must be at least 64 characters for production
  JWT_SECRET: "CHANGE_ME_GENERATE_64_CHAR_SECRET_FOR_PRODUCTION_USE"
  JWT_ISSUER: "shahin-grc-production"
  JWT_AUDIENCE: "shahin-grc-users"
  JWT_EXPIRY_MINUTES: "15"                         # Short expiry for security
  JWT_REFRESH_TOKEN_EXPIRY_DAYS: "7"               # Refresh token validity
---
apiVersion: v1
kind: Secret
metadata:
  name: claude-api-key
  namespace: shahin-grc
  labels:
    environment: production
type: Opaque
stringData:
  # Claude AI Configuration
  # Use a production API key with appropriate rate limits
  # Monitor usage at: https://console.anthropic.com/
  CLAUDE_API_KEY: "sk-ant-api03-CHANGE_ME_PRODUCTION_KEY"
  CLAUDE_MODEL: "claude-sonnet-4-5-20250514"
  CLAUDE_ENABLED: "true"
  # Optional: Set max tokens per request for cost control
  CLAUDE_MAX_TOKENS: "4096"
---
apiVersion: v1
kind: Secret
metadata:
  name: redis-password
  namespace: shahin-grc
  labels:
    environment: production
  annotations:
    secret-rotation-date: "2026-04-14"
type: Opaque
stringData:
  # Generate: openssl rand -base64 32
  REDIS_PASSWORD: "CHANGE_ME_GENERATE_32_CHAR_PASSWORD"
  # Sentinel connection for HA Redis (production uses full HA)
  REDIS_CONNECTION: "redis-sentinel-svc:26379,serviceName=shahin-master,password=CHANGE_ME_GENERATE_32_CHAR_PASSWORD,abortConnect=false,connectRetry=3"
---
# Docker registry secret for pulling images from GHCR
# Best practice: Use a dedicated service account with minimal permissions
apiVersion: v1
kind: Secret
metadata:
  name: ghcr-secret
  namespace: shahin-grc
  labels:
    environment: production
type: kubernetes.io/dockerconfigjson
stringData:
  .dockerconfigjson: |
    {
      "auths": {
        "ghcr.io": {
          "username": "CHANGE_ME_GITHUB_SERVICE_ACCOUNT",
          "password": "CHANGE_ME_GITHUB_PAT_READ_PACKAGES_ONLY",
          "auth": ""
        }
      }
    }
---
# SMTP credentials for email notifications
apiVersion: v1
kind: Secret
metadata:
  name: smtp-credentials
  namespace: shahin-grc
  labels:
    environment: production
type: Opaque
stringData:
  SMTP_HOST: "smtp.example.com"                    # Your SMTP provider
  SMTP_PORT: "587"
  SMTP_USERNAME: "CHANGE_ME"
  SMTP_PASSWORD: "CHANGE_ME"
  SMTP_FROM_EMAIL: "noreply@shahin-ai.com"
  SMTP_FROM_NAME: "Shahin GRC Platform"
  SMTP_USE_TLS: "true"
---
# Optional: Application Insights / Telemetry
apiVersion: v1
kind: Secret
metadata:
  name: telemetry-credentials
  namespace: shahin-grc
  labels:
    environment: production
type: Opaque
stringData:
  # Azure Application Insights (if using)
  APPLICATIONINSIGHTS_CONNECTION_STRING: "CHANGE_ME_IF_USING_APP_INSIGHTS"
  # Sentry DSN (if using)
  SENTRY_DSN: "CHANGE_ME_IF_USING_SENTRY"
---
# Optional: External integrations
apiVersion: v1
kind: Secret
metadata:
  name: integration-credentials
  namespace: shahin-grc
  labels:
    environment: production
type: Opaque
stringData:
  # Microsoft Graph API (for Azure AD integration)
  AZURE_TENANT_ID: "CHANGE_ME_IF_USING_AZURE_AD"
  AZURE_CLIENT_ID: "CHANGE_ME_IF_USING_AZURE_AD"
  AZURE_CLIENT_SECRET: "CHANGE_ME_IF_USING_AZURE_AD"

  # Camunda BPM (workflow engine)
  CAMUNDA_BASE_URL: "http://camunda:8085"
  CAMUNDA_USERNAME: "admin"
  CAMUNDA_PASSWORD: "CHANGE_ME"
